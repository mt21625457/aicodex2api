---
phase: 02-openai-bulk-edit-ui
plan: "01"
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/src/components/account/BulkEditAccountModal.vue
  - frontend/src/views/admin/AccountsView.vue
  - frontend/src/api/admin/accounts.ts
  - frontend/src/i18n/locales/zh.ts
  - frontend/src/i18n/locales/en.ts
autonomous: true
requirements:
  - BULK-01
  - BULK-02
  - BULK-03
  - BULK-07
user_setup: []
must_haves:
  truths:
    - 管理员可在批量编辑弹窗设置 OpenAI 自动透传和 WS mode
    - OAuth 批量编辑可设置 codex_cli_only
    - 未勾选字段不会进入 bulk-update 请求体
  artifacts:
    - frontend/src/components/account/BulkEditAccountModal.vue
    - frontend/src/i18n/locales/zh.ts
    - frontend/src/i18n/locales/en.ts
  key_links:
    - UI field toggles -> buildUpdatePayload -> adminAPI.accounts.bulkUpdate
    - Backend validation error -> appStore.showError feedback
---

<objective>
扩展批量编辑弹窗的 OpenAI 能力，与单账号编辑核心开关保持对齐并保留安全提交语义。

Purpose: 让管理员无需逐账号编辑即可完成 OpenAI 高级配置变更。
Output: 可直接提交 OpenAI 专属批量配置的 UI 与 payload 逻辑。
</objective>

<execution_context>
@/Users/yangjianbo/.codex/get-shit-done/workflows/execute-plan.md
@/Users/yangjianbo/.codex/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-openai-bulk-edit-ui/02-CONTEXT.md

@frontend/src/components/account/BulkEditAccountModal.vue
@frontend/src/components/account/EditAccountModal.vue
@frontend/src/views/admin/AccountsView.vue
@frontend/src/i18n/locales/zh.ts
@frontend/src/i18n/locales/en.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add OpenAI bulk-edit field section in modal</name>
  <files>frontend/src/components/account/BulkEditAccountModal.vue</files>
  <action>在批量编辑弹窗新增 OpenAI 专属字段分区：自动透传、WS mode、codex_cli_only（OAuth）、auto_pause_on_expired。每个字段都使用启用开关控制是否生效，沿用现有可访问性标签与禁用态样式。</action>
  <verify><automated>cd frontend && pnpm test:run</automated></verify>
  <done>弹窗可配置上述字段，UI 结构清晰，且不影响原有字段分区与提交按钮行为。</done>
</task>

<task type="auto">
  <name>Task 2: Wire payload with explicit off/false semantics</name>
  <files>frontend/src/components/account/BulkEditAccountModal.vue, frontend/src/api/admin/accounts.ts</files>
  <action>扩展 buildUpdatePayload：仅发送勾选字段；关闭场景显式发送 `false` 或 `off`；OpenAI extra 键与单编辑页一致。auto_pause_on_expired 作为顶层字段写入 bulk-update 请求体。</action>
  <verify><automated>cd frontend && pnpm build</automated></verify>
  <done>提交 payload 满足“勾选才改、关闭可回滚、键名对齐单编辑页”三项原则。</done>
</task>

<task type="auto">
  <name>Task 3: Add i18n labels and error hints for OpenAI bulk fields</name>
  <files>frontend/src/i18n/locales/zh.ts, frontend/src/i18n/locales/en.ts, frontend/src/views/admin/AccountsView.vue</files>
  <action>补齐新增字段的中英文文案与提示，明确“OpenAI 同类型账号”约束。保持错误提示沿用 appStore 统一风格，避免静默失败。</action>
  <verify><automated>cd frontend && pnpm test:run</automated></verify>
  <done>中英文文案齐全，无缺失 key，用户可理解字段作用与限制。</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [x] `cd frontend && pnpm build`
- [x] `cd frontend && pnpm test:run`
- [x] Manual check: OpenAI OAuth batch can set passthrough/ws/codex_cli_only in one submission (由 scope/payload 单测覆盖关键路径)
</verification>

<success_criteria>

- Bulk modal supports OpenAI advanced settings
- Payload semantics remain opt-in and non-destructive
- i18n text complete in zh/en

</success_criteria>

<output>
After completion, create `.planning/phases/02-openai-bulk-edit-ui/02-01-SUMMARY.md`
</output>
