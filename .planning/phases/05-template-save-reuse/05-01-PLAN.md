---
phase: 05-template-save-reuse
plan: "01"
type: execute
wave: 1
depends_on:
  - 04-01
files_modified:
  - frontend/src/components/account/BulkEditAccountModal.vue
  - frontend/src/components/account/bulkEditTemplateStore.ts
  - frontend/src/components/account/bulkEditTemplateState.ts
  - frontend/src/components/account/__tests__/bulkEditTemplateStore.spec.ts
  - frontend/src/components/account/__tests__/bulkEditTemplateState.spec.ts
  - frontend/src/i18n/locales/zh.ts
  - frontend/src/i18n/locales/en.ts
autonomous: true
requirements:
  - BULK-10
user_setup: []
must_haves:
  truths:
    - 模板必须按 platform:type 隔离，不能跨类型复用
    - 模板应用后仍保持“仅勾选字段才提交”的语义
    - 模板保存/应用/删除必须有明确反馈
  artifacts:
    - frontend/src/components/account/BulkEditAccountModal.vue
    - frontend/src/components/account/bulkEditTemplateStore.ts
    - frontend/src/components/account/bulkEditTemplateState.ts
---

<objective>
落实 v1.1 Phase 5：为 scoped 批量编辑弹窗提供模板保存与复用能力，提升重复操作效率且不破坏现有安全约束。
</objective>

<tasks>

<task type="auto">
  <name>Task 1: 模板状态模型与持久化能力</name>
  <files>frontend/src/components/account/bulkEditTemplateStore.ts, frontend/src/components/account/bulkEditTemplateState.ts</files>
  <action>定义模板记录结构、scope 过滤、upsert/remove；新增模板状态规范化与快照工具，保证模板数据可回放且类型安全。</action>
  <done>模板记录可稳定读写并按 scope 过滤，模板状态可安全标准化。</done>
</task>

<task type="auto">
  <name>Task 2: Scoped 批量弹窗模板面板接入</name>
  <files>frontend/src/components/account/BulkEditAccountModal.vue</files>
  <action>在弹窗内新增模板选择/应用/保存/删除面板，接入 localStorage，模板仅对当前 platform:type 生效。</action>
  <done>管理员可在同类账号范围内一键复用模板配置。</done>
</task>

<task type="auto">
  <name>Task 3: 文案与单测补齐</name>
  <files>frontend/src/components/account/__tests__/bulkEditTemplateStore.spec.ts, frontend/src/components/account/__tests__/bulkEditTemplateState.spec.ts, frontend/src/i18n/locales/zh.ts, frontend/src/i18n/locales/en.ts</files>
  <action>补齐模板相关中英文文案，并增加模板存储/状态归一化测试覆盖。</action>
  <done>模板关键分支具备自动化验证，提示文案可直接用于生产。</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [x] `cd frontend && pnpm -s vitest run src/components/account/__tests__/bulkEditTemplateState.spec.ts src/components/account/__tests__/bulkEditTemplateStore.spec.ts src/components/account/__tests__/bulkEditPayload.spec.ts src/components/account/__tests__/bulkEditScopeProfile.spec.ts src/views/__tests__/accountsBulkEditScope.spec.ts`
- [x] `cd frontend && pnpm -s vitest run --coverage src/components/account/__tests__/bulkEditTemplateState.spec.ts src/components/account/__tests__/bulkEditTemplateStore.spec.ts src/components/account/__tests__/bulkEditPayload.spec.ts src/components/account/__tests__/bulkEditScopeProfile.spec.ts src/views/__tests__/accountsBulkEditScope.spec.ts --coverage.include=src/components/account/bulkEditTemplateState.ts --coverage.include=src/components/account/bulkEditTemplateStore.ts --coverage.include=src/components/account/bulkEditPayload.ts --coverage.include=src/components/account/bulkEditScopeProfile.ts --coverage.include=src/views/admin/accountsBulkEditScope.ts --coverage.reporter=text`
- [x] `cd frontend && pnpm build`
</verification>
